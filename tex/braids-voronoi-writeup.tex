\documentclass[a4paper,11pt]{article}
\usepackage[margin=1.1in]{geometry}
\usepackage{f420}
\usepackage{modules/braid}

\title{ }
\author{ }
\date{\today}

\begin{document} \maketitle

\section{Definitions}

\begin{definition}
	\emph{A Voronoi diagram} is a subdivision of a \(n \times m\) table equipped with a greedy braid into regions such that
   \begin{enumerate}
	\item Left boundary of each region is composed of a single braid strand and possibly a piece of the boundary;
	\item Right boundary of each region is composed of several pieces \(e_1, e_2, \ldots, e_k\) of braid strands, such that \begin{enumerate}
	   \item the pieces \(e_1, e_2, \ldots, e_k\) cross no strand from left to right,
	   \item the strand containing \(e_i\) crosses the strand containing \(e_{i+1}\) from left to right at the point where \(e_i\) meets \(e_{i+1}\), \(i = 1,\ldots, k-1\).
	\end{enumerate}
   \end{enumerate}
\end{definition}

\begin{lemma}
	The following are equivalent:
   \begin{enumerate}
	\item Point \(p\) belongs to the Voronoi cell \(f_i\) of a Voronoi site \(s_i\);
	\item Site \(s_i\) is the leftmost site such that there is a path from \(s_i\) to \(p\) that crosses no braid strand from left to right.
   \end{enumerate}
\end{lemma}

\section{Notation}

\newcommand{\VD}{\ensuremath{\text{\sffamily VD}}\xspace}
\newcommand{\braid}{\ensuremath{\mathcal{B}}\xspace}

\begin{enumerate}
	\item \(\braid\) for the greedy braid of the \(\frac{n}{2} \times m\) table;
	\item \(\VD\) for the Voronoi diagram of \(\braid\) % the \(\frac{n}{2} \times m\) table;
	\item \(\braid^*\) for the upward \(\frac{n}{2} \times m\) greedy braid;
	\item \(\braid^{-h}\) for the \(\lr*{\frac{n}{2} + h} \times m\) greedy braid that starts \(h\) rows above the middle line;
	\item \(\VD^{-h}\) for the Voronoi diagram corresponding to \(\braid^{-h}\);
	\item \(s_0, \ldots, s_{m+n}\) for the sites of the Voronoi diagram;
	\item \(f_0, \ldots, f_{m+n}\); \(f_0^{-h}, \ldots, f_{m+n}^{-h}\) for the Voronoi cells of \(\VD\) and \(\VD^{-h}\) correspondingly;
	\item \(c_0, \ldots, c_{m+n}\); \(c_0^{-h}, \ldots, c_{m+n}^{-h}\) for the lower right corners of the Voronoi cells of \(\VD\) and \(\VD^{-h}\) correspondingly.
\end{enumerate}


\begin{figure}[ht] \centering
	\input{imgb/braidvd-allsites}

	\input{imgb/braidvd-crosstwice}

	\caption{(a) Voronoi diagram for a given greedy braid, (b) \(\VD^{-2}\), (c) paths from \(s_6\) to \(c_6^{-2}\) through \(p_1\) and from \(s_7\) to \(c_7^{-2}\) through \(p_2\)}
	\label{fig:vd-ex}
\end{figure}


\section{Query}

\begin{problem}
	Given braid \braid, the lower right corners \(c_0^{-h}, \ldots, c_{m+n}^{-h}\) of the Voronoi cells of \(\VD^{-h}\), point \(p\) and a number \(i\), check whether \(p \in f_i^{-h}\), \(p\) is to the left or to the right from \(f_i^{-h}\).
\end{problem}

\begin{lemma}
	The following are equivalent:
   \begin{enumerate}
	\item Point \(p\) belongs to the Voronoi cell \(f_i^{-h}\) of \(\VD^{-h}\);
	\item There is a path from \(s_i\) to \(c_i^{-h}\) passing through \(p\) that crosses no strand of \braid twice.
   \end{enumerate}
\end{lemma}

The path can utilize diagonal edges, see Figure~\ref{fig:vd-ex},~(c): \(p_1 \in f_6^{-2}\) (green), \(p_2 \in f_7^{-2}\) (yellow).


\subsection{Entanglement of triples oracle}

\begin{definition}
	We call two triples of numbers \(\lr*{a_1, a_2, a_3}\),
	\(\lr*{b_1, b_2, b_3}\) \emph{entangled} if
	\[ a_1 < b_1,\ a_2 > b_2,\ a_3 < b_3\quad\text{or}\quad
	   a_1 > b_1,\ a_2 < b_2,\ a_3 > b_3\]
\end{definition}

\begin{theorem}
	There exists a data structure that can store a set of \(N\) triples
	\[S = \set*{\lr*{a^1_1, a^1_2, a^1_3}, \ldots, \lr*{a^N_1, a^N_2, a^N_3}}\]
	and, given a query triple \(q = \lr*{q_1, q_2, q_3}\), output
	in time \(\Ot\lr*{1}\)  %  Count logs precisely
	the number of triples in \(S\) that are entangled with \(q\).
\end{theorem}

\begin{proof}
	Store the set \(S\) in a 3-dimensional range tree [{\color{magenta} cite!}].
	A \(d\)-dimensional range tree is a data structure that stores several points
	in \(\mathbb{R}^d\) and effectively reports all the stored points that are
	inside a \(d\)-dimensional rectangular parallelepiped defined by
	its lower and higher coordinates on each axis.

\begin{figure}[ht] \centering
	\input{imgb/paral-trans}

	\caption{(a) A triple \(\lr*{a^i_1, a^i_2, a^i_3}\) entangled
	with \(\lr*{q_1, q_2, q_3}\),
	         (b) a range query that finds this triple}
	\label{fig:paral-trans}
\end{figure}

	An entanglement query can then be interpreted as two 3-dimensional range
	queries, as shown in Figure~\ref{fig:paral-trans}:
   \begin{enumerate}
	\item \(a_1 < q_1,\ a_2 > q_2,\ a_3 < q_3\) is a 3-dimensional parallelepiped
	  to the left, further and lower than a point \(\lr*{q_1, q_2, q_3}\);
	\item \(a_1 > q_1,\ a_2 < q_2,\ a_3 > q_3\) is a 3-dimensional parallelepiped
	  to the right, closer and higher than a point \(\lr*{q_1, q_2, q_3}\).
   \end{enumerate}
\end{proof}

\begin{remark}
	The construction of a 3-dimensional range tree takes \(O \lr*{n \log^2 n}\) time,
	and a range query takes \(O \lr*{\log n}\) time.
\end{remark}


%\bibliography{}{}
%\bibliographystyle{plain}

\end{document}
